
1. ДИТ уже выгружает cdr, нужно передать зип архив на увр.
2. На увр принять зип архив, разархивировать. В архиве 1 файл json, в нём много объектов - 1 объект = один вызов.
3. создать пустой файл, пройтись циклом по всем объектом в json и заменить инн на id оператора - список операторов с инн нужно брать из другого файла (зип в котором csv)
4. пройтись циклом по новому файлу - найти совпадения по А, Б, С номеру и времени вызова с записями в clickhouse (совпадение по времени может быть не точным +- пару минут)
5. добавить в таблицу id_src и id_dst и duration



ТЗ для chatGPT
1. Скрипт должен раз в минуту проверять наличие файлов .zip в папке
2. Названия файлов имеют вид 1345_2024_09_26_08_20_00.zip, где 2024_09_26_08_20_00 дата и время.
3. Разархивировать в рабочую директорию первый по дате-времени файл
	3.1. формат разархивированного файла -.json в котором хранится множество объектов
	3.2. объект имеет вид - {"ID_UVR":1345,"NUM_A":"74957999466","NUM_B":"74954809485","DATE":"2024-07-04T07:30:21+03:00","INN_SRC":"7710436796","INN_DST":"7740000076","DURATION":6}
4. Раз в 5 минут проверять наличие новых файлов в папке /etc/uvr/digests/operators
5. Файлы имеют вид  OPR_2024_09_25_00_00_00.zip где 2024_09_25_00_00_00 это дата-время.
6. При наличии нового файла разархивировать его в рабочую директорию и удалить предыдущий файл.
	6.1. структура csv состоит из столбцов |id_src|opr_name|opr_nick|inn|bdpn_code|name_brand| 
7. Циклом сравнить INN_SRC и INN_DST каждого объекта из файла в пункте 3 со значением из столбца inn файла из пункта 6
	7.1 заменить INN_SRC на значение id_src
	7.2 заменить INN_DST на значение id_src
8. Циклом сравнить каждый объект из файла в пункте 7 с записями в СУБД clickhouse (сравнение проводить по точному совпадению NUM_A, NUM_B, NUM_C и не точному совпадению DATE разница может достигать 5 минут)
	8.1 Структура таблицы сalls в СУБД clickhouse - NUM_A | NUM_B | NUM_D | NUM_C | DATE | DATE_ACT | ID_SRC | ID_DST | SESSION_ID | ID_REL | VRF_RSP | RELEASE_CODE | DURATION | ID_UVR_T | CALL_ID | CALL_TYPE
	8.2 При совпадении заполнить поля ID_SRC, ID_DST, DURATION соблюдая условие:
		ID_SRC = INN_SRC
		ID_DST = INN_DST
		DURATION = DURATION
		если INN_SRC = 11069 - ID_SRC не заполнять
		если INN_DST = 11069 - ID_DST не заполнять
 9. Добавь логирование.
    
 Было не так быстро как хотелось бы.   