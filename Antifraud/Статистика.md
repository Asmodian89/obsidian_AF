Файлы статистики, которые формирует УВр - csv файл.
Структура файла:
  
|ID_SRC|START_DATE|DUR|ATTMS|TBVRF|RJCTS|TMOUTS|ERR1|ERR2|

где ID_SRC - id оператора с которого пришёл вызов
START_DATE - дата/время начала сбора статистики
DUR - время сбора статистики в секундах (по умолчанию 900)
остальное это счётчики которые формируются магией УВр.

В ванильном УВр, ID_SRC  берётся из префикса в поле From. В нашем случае его нет - УВр устанавливает значение по умолчанию - 0.

Задумка в том что изменить исходный код так что бы вместо id_src подставлялся А номер.
Должен получиться файл заполненный всеми вызовами прошедшими через УВр за 15 минут. (насколько я понимаю в статистике учитываются только входящая верификация).

У нас уже есть скрипт который обрабатывает [[CDR]], одна из его функций это замена инн оператора из файла с cdr на значение id из справочника грчц.
Нужно будет построчно сравнить каждую и запись из файла со статистикой с измененным CDR ( проверяем А номер и время +- пару минут).